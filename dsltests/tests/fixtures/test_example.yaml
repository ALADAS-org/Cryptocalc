name: "Complete Wallet Workflow"
description: "Génération, chiffrement et validation d'un wallet"

setup:
  entropy_size: 256
  blockchain: BTC

tests:
  - name: "Full workflow test"
    steps:
      # 1. Générer l'entropie
      - action: generateEntropy
        params:
          size: 256
        assign: entropy
        
      # 2. Créer le wallet
      - action: generateWallet
        params:
          type: HD_WALLET
          entropy: $entropy
          blockchain: BTC
          passphrase: "MyBip32Pass"
        assign: wallet
        
      # 3. Chiffrer la clé privée
      - action: encrypt
        params:
          privateKey: $wallet.privateKey
          passphrase: "MyBip38Pass"
        assign: encrypted
        
      # 4. Valider l'adresse
      - action: validateAddress
        params:
          address: $wallet.address
          blockchain: BTC
        assign: isValid
        
      # 5. Sauvegarder
      - action: save
        target: $wallet
        assign: saveResult
        
    assertions:
      # Vérifier l'entropie
      - property: $entropy
        hasLength: 64
        
      # Vérifier le wallet
      - property: $wallet.type
        equals: HD_WALLET
      - property: $wallet.address
        matches: "^[13][a-km-zA-HJ-NP-Z1-9]{25,34}$"
        
      # Vérifier le chiffrement
      - property: $encrypted
        matches: "^6PR"
        
      # Vérifier la validation
      - property: $isValid
        isTrue: true
        
      # Vérifier la sauvegarde
      - property: $saveResult.success
        isTrue: true